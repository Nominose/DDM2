25-12-25 21:14:06.330 - INFO:   name: ct_denoise
  phase: train
  gpu_ids: [0]
  path:[
    log: experiments/ct_denoise_251225_211406/logs
    tb_logger: experiments/ct_denoise_251225_211406/tb_logger
    results: experiments/ct_denoise_251225_211406/results
    checkpoint: experiments/ct_denoise_251225_211406/checkpoint
    resume_state: None
    experiments_root: experiments/ct_denoise_251225_211406
  ]
  datasets:[
    train:[
      name: ct
      dataroot: /host/d/file/fixedCT_static_simulation_train_test_gaussian_local.xlsx
      data_root: /host/d/file/simulation/
      train_batches: [5]
      val_batches: [5]
      valid_mask: [0, 1000]
      slice_range: [30, 80]
      phase: train
      padding: 3
      val_volume_idx: all
      val_slice_idx: all
      batch_size: 1
      in_channel: 1
      num_workers: 4
      use_shuffle: True
      image_size: 512
      lr_flip: 0.5
      HU_MIN: 0.0
      HU_MAX: 80.0
      teacher_n2n_root: /host/d/file/pre/noise2noise/pred_images/
      teacher_n2n_epoch: 78
    ]
    val:[
      name: ct
      dataroot: /host/d/file/fixedCT_static_simulation_train_test_gaussian_local.xlsx
      data_root: /host/d/file/simulation/
      train_batches: [5]
      val_batches: [5]
      valid_mask: [0, 1000]
      slice_range: [30, 80]
      phase: val
      padding: 3
      val_volume_idx: 8
      val_slice_idx: [25]
      batch_size: 1
      in_channel: 1
      num_workers: 0
      image_size: 512
      lr_flip: 0.0
      HU_MIN: 0.0
      HU_MAX: 80.0
      teacher_n2n_root: /host/d/file/pre/noise2noise/pred_images/
      teacher_n2n_epoch: 78
      data_len: 3
    ]
  ]
  model:[
    which_model_G: mri
    finetune_norm: False
    drop_rate: 0.0
    unet:[
      in_channel: 1
      out_channel: 1
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [1, 2, 4, 8, 8]
      attn_res: [16]
      res_blocks: 2
      dropout: 0.0
      version: v1
    ]
    beta_schedule:[
      train:[
        schedule: rev_warmup70
        n_timestep: 1000
        linear_start: 5e-05
        linear_end: 0.01
      ]
      val:[
        schedule: rev_warmup70
        n_timestep: 1000
        linear_start: 5e-05
        linear_end: 0.01
      ]
    ]
    diffusion:[
      image_size: 512
      channels: 1
      conditional: True
    ]
  ]
  train:[
    n_iter: 100000
    val_freq: 1000
    save_checkpoint_freq: 10000
    print_freq: 100
    optimizer:[
      type: adam
      lr: 0.0001
    ]
    ema_scheduler:[
      step_start_ema: 5000
      update_ema_every: 1
      ema_decay: 0.9999
    ]
  ]
  noise_model:[
    resume_state: None
    initial_stage_file: experiments/ct_denoise_teacher/stage2_matched.txt
    drop_rate: 0.0
    unet:[
      in_channel: 2
      out_channel: 1
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [1, 2, 4, 8, 8]
      attn_res: [16]
      res_blocks: 2
      dropout: 0.0
      version: v1
    ]
    beta_schedule:[
      linear_start: 5e-05
      linear_end: 0.01
    ]
    n_iter: 50000
    val_freq: 2000
    save_checkpoint_freq: 10000
    print_freq: 100
    optimizer:[
      type: adam
      lr: 0.0001
    ]
  ]
  stage2_file: experiments/ct_denoise_teacher/stage2_matched.txt
  distributed: False

25-12-25 21:14:10.786 - INFO: CT dataset [ct] is created. Size: 50
25-12-25 21:14:13.271 - INFO: CT dataset [ct] is created. Size: 1
25-12-25 21:14:13.271 - INFO: Initial Dataset Finished
25-12-25 21:14:14.835 - INFO: Initialization method [orthogonal]
25-12-25 21:14:15.625 - INFO: [DDM2] is created.
25-12-25 21:14:15.626 - INFO: Initial Model Finished
25-12-25 21:14:49.382 - INFO: <epoch:  2, iter:     100> l_pix: 4.1733e-02 
25-12-25 21:15:08.057 - INFO: <epoch:  4, iter:     200> l_pix: 2.6299e-02 
25-12-25 21:15:27.290 - INFO: <epoch:  6, iter:     300> l_pix: 1.9713e-02 
25-12-25 21:15:46.692 - INFO: <epoch:  8, iter:     400> l_pix: 1.5326e-02 
25-12-25 21:16:05.009 - INFO: <epoch: 10, iter:     500> l_pix: 2.9570e-02 
25-12-25 21:16:24.545 - INFO: <epoch: 12, iter:     600> l_pix: 1.7870e-02 
25-12-25 21:16:42.884 - INFO: <epoch: 14, iter:     700> l_pix: 2.3520e-02 
25-12-25 21:17:02.385 - INFO: <epoch: 16, iter:     800> l_pix: 1.9660e-02 
25-12-25 21:17:22.070 - INFO: <epoch: 18, iter:     900> l_pix: 3.5730e-02 
25-12-25 21:17:40.498 - INFO: <epoch: 20, iter:   1,000> l_pix: 1.9896e-02 
25-12-25 21:19:26.046 - INFO: <epoch: 22, iter:   1,100> l_pix: 2.0729e-02 
25-12-25 21:19:44.973 - INFO: <epoch: 24, iter:   1,200> l_pix: 3.3865e-02 
25-12-25 21:20:05.062 - INFO: <epoch: 26, iter:   1,300> l_pix: 1.6549e-02 
25-12-25 21:20:25.444 - INFO: <epoch: 28, iter:   1,400> l_pix: 1.9474e-02 
25-12-25 21:20:44.864 - INFO: <epoch: 30, iter:   1,500> l_pix: 1.8872e-02 
25-12-25 21:21:04.047 - INFO: <epoch: 32, iter:   1,600> l_pix: 1.4299e-02 
25-12-25 21:21:24.194 - INFO: <epoch: 34, iter:   1,700> l_pix: 2.7287e-02 
25-12-25 21:21:43.364 - INFO: <epoch: 36, iter:   1,800> l_pix: 1.6115e-02 
25-12-25 21:22:04.074 - INFO: <epoch: 38, iter:   1,900> l_pix: 3.1837e-02 
25-12-25 21:22:23.167 - INFO: <epoch: 40, iter:   2,000> l_pix: 1.7942e-02 
25-12-25 21:24:07.465 - INFO: <epoch: 42, iter:   2,100> l_pix: 1.7419e-02 
25-12-25 21:24:26.931 - INFO: <epoch: 44, iter:   2,200> l_pix: 1.6943e-02 
25-12-25 21:24:46.530 - INFO: <epoch: 46, iter:   2,300> l_pix: 1.0287e-02 
25-12-25 21:25:06.573 - INFO: <epoch: 48, iter:   2,400> l_pix: 2.2415e-02 
25-12-25 21:25:24.945 - INFO: <epoch: 50, iter:   2,500> l_pix: 2.5181e-02 
25-12-25 21:25:44.424 - INFO: <epoch: 52, iter:   2,600> l_pix: 2.3333e-02 
25-12-25 21:26:04.060 - INFO: <epoch: 54, iter:   2,700> l_pix: 1.4758e-02 
25-12-25 21:26:22.806 - INFO: <epoch: 56, iter:   2,800> l_pix: 2.5920e-02 
25-12-25 21:26:45.425 - INFO: <epoch: 58, iter:   2,900> l_pix: 1.5699e-02 
25-12-25 21:27:05.606 - INFO: <epoch: 60, iter:   3,000> l_pix: 1.8095e-02 
25-12-25 21:28:45.392 - INFO: <epoch: 62, iter:   3,100> l_pix: 1.6336e-02 
25-12-25 21:29:04.315 - INFO: <epoch: 64, iter:   3,200> l_pix: 1.6126e-02 
25-12-25 21:29:24.328 - INFO: <epoch: 66, iter:   3,300> l_pix: 1.8298e-02 
25-12-25 21:29:45.827 - INFO: <epoch: 68, iter:   3,400> l_pix: 1.4513e-02 
25-12-25 21:30:05.285 - INFO: <epoch: 70, iter:   3,500> l_pix: 2.3841e-02 
25-12-25 21:30:25.107 - INFO: <epoch: 72, iter:   3,600> l_pix: 2.0739e-02 
25-12-25 21:30:44.853 - INFO: <epoch: 74, iter:   3,700> l_pix: 1.8650e-02 
25-12-25 21:31:03.653 - INFO: <epoch: 76, iter:   3,800> l_pix: 1.5236e-02 
25-12-25 21:31:24.474 - INFO: <epoch: 78, iter:   3,900> l_pix: 1.1680e-02 
25-12-25 21:31:43.284 - INFO: <epoch: 80, iter:   4,000> l_pix: 1.4761e-02 
25-12-25 21:33:28.083 - INFO: <epoch: 82, iter:   4,100> l_pix: 1.4744e-02 
25-12-25 21:33:49.950 - INFO: <epoch: 84, iter:   4,200> l_pix: 2.1354e-02 
25-12-25 21:34:08.555 - INFO: <epoch: 86, iter:   4,300> l_pix: 1.9627e-02 
25-12-25 21:34:27.912 - INFO: <epoch: 88, iter:   4,400> l_pix: 1.0393e-02 
25-12-25 21:34:47.095 - INFO: <epoch: 90, iter:   4,500> l_pix: 1.4020e-02 
25-12-25 21:35:06.975 - INFO: <epoch: 92, iter:   4,600> l_pix: 1.3028e-02 
25-12-25 21:35:27.234 - INFO: <epoch: 94, iter:   4,700> l_pix: 1.5477e-02 
25-12-25 21:35:46.406 - INFO: <epoch: 96, iter:   4,800> l_pix: 1.8002e-02 
25-12-25 21:36:06.953 - INFO: <epoch: 98, iter:   4,900> l_pix: 1.4793e-02 
25-12-25 21:36:28.612 - INFO: <epoch:100, iter:   5,000> l_pix: 1.1212e-02 
25-12-25 21:38:08.620 - INFO: <epoch:102, iter:   5,100> l_pix: 1.2095e-02 
25-12-25 21:38:27.058 - INFO: <epoch:104, iter:   5,200> l_pix: 1.2225e-02 
25-12-25 21:38:46.357 - INFO: <epoch:106, iter:   5,300> l_pix: 1.6274e-02 
25-12-25 21:39:05.667 - INFO: <epoch:108, iter:   5,400> l_pix: 1.1584e-02 
25-12-25 21:39:23.909 - INFO: <epoch:110, iter:   5,500> l_pix: 2.0544e-02 
25-12-25 21:39:43.371 - INFO: <epoch:112, iter:   5,600> l_pix: 1.9597e-02 
25-12-25 21:40:02.729 - INFO: <epoch:114, iter:   5,700> l_pix: 1.7312e-02 
25-12-25 21:40:21.345 - INFO: <epoch:116, iter:   5,800> l_pix: 1.9256e-02 
25-12-25 21:40:43.214 - INFO: <epoch:118, iter:   5,900> l_pix: 2.1670e-02 
25-12-25 21:41:02.220 - INFO: <epoch:120, iter:   6,000> l_pix: 1.3106e-02 
25-12-25 21:42:42.852 - INFO: <epoch:122, iter:   6,100> l_pix: 1.5855e-02 
25-12-25 21:43:01.682 - INFO: <epoch:124, iter:   6,200> l_pix: 1.0428e-02 
25-12-25 21:43:23.588 - INFO: <epoch:126, iter:   6,300> l_pix: 1.3832e-02 
25-12-25 21:43:43.687 - INFO: <epoch:128, iter:   6,400> l_pix: 1.4471e-02 
25-12-25 21:44:04.176 - INFO: <epoch:130, iter:   6,500> l_pix: 1.6753e-02 
25-12-25 21:44:24.380 - INFO: <epoch:132, iter:   6,600> l_pix: 1.8060e-02 
25-12-25 21:44:45.917 - INFO: <epoch:134, iter:   6,700> l_pix: 1.4069e-02 
25-12-25 21:45:05.358 - INFO: <epoch:136, iter:   6,800> l_pix: 2.1655e-02 
25-12-25 21:45:24.902 - INFO: <epoch:138, iter:   6,900> l_pix: 1.5747e-02 
25-12-25 21:45:44.530 - INFO: <epoch:140, iter:   7,000> l_pix: 1.3703e-02 
25-12-25 21:47:26.149 - INFO: <epoch:142, iter:   7,100> l_pix: 1.2722e-02 
25-12-25 21:47:48.300 - INFO: <epoch:144, iter:   7,200> l_pix: 1.7590e-02 
25-12-25 21:48:07.433 - INFO: <epoch:146, iter:   7,300> l_pix: 1.1875e-02 
25-12-25 21:48:27.835 - INFO: <epoch:148, iter:   7,400> l_pix: 1.0966e-02 
25-12-25 21:48:46.279 - INFO: <epoch:150, iter:   7,500> l_pix: 1.1312e-02 
25-12-25 21:49:05.860 - INFO: <epoch:152, iter:   7,600> l_pix: 1.6540e-02 
25-12-25 21:49:26.072 - INFO: <epoch:154, iter:   7,700> l_pix: 1.1648e-02 
25-12-25 21:49:46.376 - INFO: <epoch:156, iter:   7,800> l_pix: 1.6169e-02 
25-12-25 21:50:05.982 - INFO: <epoch:158, iter:   7,900> l_pix: 1.1091e-02 
25-12-25 21:50:25.844 - INFO: <epoch:160, iter:   8,000> l_pix: 1.4107e-02 
25-12-25 21:52:08.448 - INFO: <epoch:162, iter:   8,100> l_pix: 1.1305e-02 
25-12-25 21:52:28.805 - INFO: <epoch:164, iter:   8,200> l_pix: 1.2482e-02 
25-12-25 21:52:47.160 - INFO: <epoch:166, iter:   8,300> l_pix: 1.1333e-02 
25-12-25 21:53:06.079 - INFO: <epoch:168, iter:   8,400> l_pix: 1.0757e-02 
25-12-25 21:53:24.535 - INFO: <epoch:170, iter:   8,500> l_pix: 1.2051e-02 
25-12-25 21:53:44.900 - INFO: <epoch:172, iter:   8,600> l_pix: 1.1445e-02 
25-12-25 21:54:04.737 - INFO: <epoch:174, iter:   8,700> l_pix: 1.0855e-02 
25-12-25 21:54:26.182 - INFO: <epoch:176, iter:   8,800> l_pix: 9.2827e-03 
25-12-25 21:54:46.703 - INFO: <epoch:178, iter:   8,900> l_pix: 1.4398e-02 
25-12-25 21:55:06.283 - INFO: <epoch:180, iter:   9,000> l_pix: 1.1041e-02 
25-12-25 21:56:49.841 - INFO: <epoch:182, iter:   9,100> l_pix: 1.0421e-02 
25-12-25 21:57:10.622 - INFO: <epoch:184, iter:   9,200> l_pix: 1.4991e-02 
25-12-25 21:57:29.164 - INFO: <epoch:186, iter:   9,300> l_pix: 1.5852e-02 
25-12-25 21:57:48.722 - INFO: <epoch:188, iter:   9,400> l_pix: 9.3037e-03 
25-12-25 21:58:07.228 - INFO: <epoch:190, iter:   9,500> l_pix: 1.0729e-02 
25-12-25 21:58:29.155 - INFO: <epoch:192, iter:   9,600> l_pix: 1.0990e-02 
25-12-25 21:58:49.211 - INFO: <epoch:194, iter:   9,700> l_pix: 1.4454e-02 
25-12-25 21:59:07.635 - INFO: <epoch:196, iter:   9,800> l_pix: 1.2670e-02 
25-12-25 21:59:27.171 - INFO: <epoch:198, iter:   9,900> l_pix: 1.2751e-02 
25-12-25 21:59:46.913 - INFO: <epoch:200, iter:  10,000> l_pix: 1.7546e-02 
25-12-25 22:01:08.192 - INFO: Saving models and training states.
25-12-25 22:01:12.874 - INFO: Saved model in [experiments/ct_denoise_251225_211406/checkpoint/latest_gen.pth] ...
25-12-25 22:01:32.403 - INFO: <epoch:202, iter:  10,100> l_pix: 1.0095e-02 
25-12-25 22:01:51.821 - INFO: <epoch:204, iter:  10,200> l_pix: 1.1346e-02 
25-12-25 22:02:11.924 - INFO: <epoch:206, iter:  10,300> l_pix: 1.0504e-02 
25-12-25 22:02:32.193 - INFO: <epoch:208, iter:  10,400> l_pix: 1.0367e-02 
25-12-25 22:02:52.111 - INFO: <epoch:210, iter:  10,500> l_pix: 1.0820e-02 
25-12-25 22:03:10.986 - INFO: <epoch:212, iter:  10,600> l_pix: 1.2730e-02 
25-12-25 22:03:30.720 - INFO: <epoch:214, iter:  10,700> l_pix: 1.1214e-02 
25-12-25 22:03:49.197 - INFO: <epoch:216, iter:  10,800> l_pix: 1.6263e-02 
25-12-25 22:04:09.009 - INFO: <epoch:218, iter:  10,900> l_pix: 1.9083e-02 
25-12-25 22:04:31.488 - INFO: <epoch:220, iter:  11,000> l_pix: 1.2556e-02 
25-12-25 22:06:11.936 - INFO: <epoch:222, iter:  11,100> l_pix: 1.1302e-02 
25-12-25 22:06:33.336 - INFO: <epoch:224, iter:  11,200> l_pix: 1.3312e-02 
25-12-25 22:06:53.421 - INFO: <epoch:226, iter:  11,300> l_pix: 9.6011e-03 
25-12-25 22:07:13.570 - INFO: <epoch:228, iter:  11,400> l_pix: 9.7232e-03 
25-12-25 22:07:33.417 - INFO: <epoch:230, iter:  11,500> l_pix: 1.0211e-02 
25-12-25 22:07:53.946 - INFO: <epoch:232, iter:  11,600> l_pix: 1.2524e-02 
25-12-25 22:08:13.935 - INFO: <epoch:234, iter:  11,700> l_pix: 8.7011e-03 
25-12-25 22:08:33.426 - INFO: <epoch:236, iter:  11,800> l_pix: 1.3337e-02 
25-12-25 22:08:51.768 - INFO: <epoch:238, iter:  11,900> l_pix: 9.9667e-03 
25-12-25 22:09:11.408 - INFO: <epoch:240, iter:  12,000> l_pix: 1.2124e-02 
25-12-25 22:10:52.346 - INFO: <epoch:242, iter:  12,100> l_pix: 1.3768e-02 
25-12-25 22:11:11.755 - INFO: <epoch:244, iter:  12,200> l_pix: 1.3067e-02 
